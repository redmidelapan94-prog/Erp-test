<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeminiERP Pro - Enterprise Suite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @media print { .no-print { display: none; } }
    </style>
</head>
<body class="bg-slate-50 font-sans text-slate-800">

<div id="app" class="flex min-h-screen">
    <aside class="w-72 bg-slate-900 text-white p-6 no-print hidden lg:block shadow-xl">
        <div class="flex items-center gap-3 mb-10">
            <div class="bg-blue-500 p-2 rounded-lg"><i class="fas fa-rocket text-xl"></i></div>
            <h1 class="text-xl font-bold tracking-tight">Gemini<span class="text-blue-400">ERP</span></h1>
        </div>
        
        <nav class="space-y-2">
            <p class="text-xs font-semibold text-slate-500 uppercase mb-2">Main Menu</p>
            <button @click="view = 'dashboard'" :class="navClass(view === 'dashboard')"><i class="fas fa-home w-6"></i> Dashboard</button>
            <button @click="view = 'inventory'" :class="navClass(view === 'inventory')"><i class="fas fa-boxes w-6"></i> Inventori & Gudang</button>
            <button @click="view = 'sales'" :class="navClass(view === 'sales')"><i class="fas fa-cash-register w-6"></i> Kasir / POS</button>
            <button @click="view = 'customers'" :class="navClass(view === 'customers')"><i class="fas fa-users w-6"></i> Pelanggan (CRM)</button>
            <button @click="view = 'finance'" :class="navClass(view === 'finance')"><i class="fas fa-wallet w-6"></i> Keuangan (P&L)</button>
        </nav>

        <div class="mt-20 p-4 bg-slate-800 rounded-xl">
            <p class="text-xs text-slate-400">Sistem Status</p>
            <div class="flex items-center gap-2 mt-1">
                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                <span class="text-sm">Online - v2.1</span>
            </div>
        </div>
    </aside>

    <main class="flex-1 p-4 md:p-10 overflow-y-auto">
        
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 no-print">
            <div>
                <h2 class="text-2xl font-bold text-slate-800 capitalize">{{ view }}</h2>
                <p class="text-slate-500 text-sm">Update terakhir: {{ lastUpdate }}</p>
            </div>
            <div class="flex gap-3">
                <button @click="window.print()" class="bg-white border border-slate-200 px-4 py-2 rounded-lg text-sm font-medium hover:bg-slate-100 transition shadow-sm">
                    <i class="fas fa-print mr-2"></i> Cetak Laporan
                </button>
                <div class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm shadow-lg shadow-blue-200">
                    <i class="fas fa-user-circle mr-2"></i> Admin Mode
                </div>
            </div>
        </header>

        <div v-if="view === 'dashboard'" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <p class="text-slate-400 text-sm font-medium">Omzet Penjualan</p>
                    <h3 class="text-2xl font-bold mt-1 text-blue-600">Rp {{ formatIDR(totalSalesValue) }}</h3>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <p class="text-slate-400 text-sm font-medium">Estimasi Laba Bersih</p>
                    <h3 class="text-2xl font-bold mt-1 text-emerald-600">Rp {{ formatIDR(totalProfit) }}</h3>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <p class="text-slate-400 text-sm font-medium">Total Produk</p>
                    <h3 class="text-2xl font-bold mt-1">{{ products.length }} Item</h3>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <p class="text-slate-400 text-sm font-medium">Stok Hampir Habis</p>
                    <h3 class="text-2xl font-bold mt-1 text-rose-500">{{ lowStockCount }} Produk</h3>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                <h4 class="font-bold mb-4">Tren Transaksi</h4>
                <canvas id="salesChart" height="100"></canvas>
            </div>
        </div>

        <div v-if="view === 'inventory'" class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
            <div class="p-6 border-b flex justify-between items-center">
                <h4 class="font-bold text-lg">Daftar Stok Barang</h4>
                <button class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">+ Tambah Barang</button>
            </div>
            <table class="w-full text-left">
                <thead class="bg-slate-50 text-slate-500 text-sm uppercase">
                    <tr>
                        <th class="p-4">SKU/Produk</th>
                        <th class="p-4">HPP (Modal)</th>
                        <th class="p-4">Harga Jual</th>
                        <th class="p-4 text-center">Stok Tersedia</th>
                        <th class="p-4 text-right">Aksi</th>
                    </tr>
                </thead>
                <tbody class="divide-y">
                    <tr v-for="p in products" class="hover:bg-slate-50 transition">
                        <td class="p-4">
                            <p class="font-bold text-slate-800">{{ p.name }}</p>
                            <span class="text-xs px-2 py-1 bg-slate-100 rounded text-slate-500">{{ p.category }}</span>
                        </td>
                        <td class="p-4 text-slate-500">Rp {{ formatIDR(p.cost) }}</td>
                        <td class="p-4 font-semibold">Rp {{ formatIDR(p.price) }}</td>
                        <td class="p-4 text-center">
                            <span :class="p.stock < 10 ? 'bg-rose-100 text-rose-600 px-3 py-1 rounded-full font-bold text-xs' : 'bg-green-100 text-green-600 px-3 py-1 rounded-full font-bold text-xs'">
                                {{ p.stock }} Unit
                            </span>
                        </td>
                        <td class="p-4 text-right">
                            <button class="text-blue-500 hover:text-blue-700 mr-3"><i class="fas fa-edit"></i></button>
                            <button class="text-rose-500 hover:text-rose-700"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div v-if="view === 'sales'" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="lg:col-span-2 space-y-6">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <h4 class="font-bold mb-4 flex items-center gap-2"><i class="fas fa-shopping-basket text-blue-500"></i> Keranjang Kasir</h4>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="md:col-span-2">
                            <label class="text-xs text-slate-400 block mb-1">Pilih Produk</label>
                            <select v-model="transaction.productId" class="w-full border p-2.5 rounded-xl bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                                <option v-for="p in products" :value="p.id">{{ p.name }} (Stok: {{p.stock}})</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-xs text-slate-400 block mb-1">Jumlah</label>
                            <input v-model.number="transaction.qty" type="number" min="1" class="w-full border p-2.5 rounded-xl bg-slate-50 outline-none">
                        </div>
                        <div class="flex items-end">
                            <button @click="processTransaction" class="w-full bg-blue-600 text-white py-2.5 rounded-xl font-bold hover:bg-blue-700 shadow-lg shadow-blue-100 transition">
                                Input Transaksi
                            </button>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                    <div class="p-4 bg-slate-50 border-b font-bold text-sm uppercase text-slate-500">Log Transaksi Terakhir</div>
                    <table class="w-full text-left text-sm">
                        <tbody class="divide-y">
                            <tr v-for="s in salesHistory" class="hover:bg-slate-50">
                                <td class="p-4 text-slate-400 italic">{{ s.time }}</td>
                                <td class="p-4 font-bold">{{ getProductName(s.productId) }}</td>
                                <td class="p-4">{{ s.qty }}x</td>
                                <td class="p-4 text-right font-bold text-blue-600">Rp {{ formatIDR(s.total) }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="space-y-4">
                <div class="bg-slate-900 text-white p-6 rounded-2xl shadow-xl">
                    <h4 class="text-slate-400 text-sm font-semibold mb-6">RINGKASAN HARIAN</h4>
                    <div class="space-y-4">
                        <div class="flex justify-between border-b border-slate-800 pb-2">
                            <span>Subtotal</span>
                            <span class="font-bold">Rp {{ formatIDR(totalSalesValue) }}</span>
                        </div>
                        <div class="flex justify-between border-b border-slate-800 pb-2">
                            <span>Pajak (PPN 11%)</span>
                            <span class="text-slate-400">Rp {{ formatIDR(totalSalesValue * 0.11) }}</span>
                        </div>
                        <div class="flex justify-between pt-2">
                            <span class="text-xl font-bold text-blue-400">Total Akhir</span>
                            <span class="text-xl font-bold text-blue-400">Rp {{ formatIDR(totalSalesValue * 1.11) }}</span>
                        </div>
                    </div>
                </div>
                <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                    <p class="text-xs text-blue-700 font-medium italic"><i class="fas fa-info-circle mr-1"></i> Transaksi akan otomatis memotong stok gudang dan masuk ke laporan laba rugi.</p>
                </div>
            </div>
        </div>

        <div v-if="view === 'customers'" class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6">
            <div class="flex justify-between mb-6">
                <h4 class="font-bold text-lg">Database Pelanggan</h4>
                <input type="text" placeholder="Cari pelanggan..." class="border px-4 py-2 rounded-lg text-sm outline-none w-64">
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div v-for="c in customers" class="p-4 border rounded-xl hover:shadow-md transition cursor-pointer">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center font-bold">{{ c.name[0] }}</div>
                        <div>
                            <p class="font-bold text-sm">{{ c.name }}</p>
                            <p class="text-xs text-slate-400">{{ c.email }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div v-if="view === 'finance'" class="space-y-6">
            <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-100">
                <h4 class="font-bold text-2xl mb-6 text-center">Laporan Laba Rugi</h4>
                <div class="max-w-md mx-auto space-y-4">
                    <div class="flex justify-between text-lg border-b py-2">
                        <span>Total Penjualan (Revenue)</span>
                        <span class="font-bold text-blue-600">Rp {{ formatIDR(totalSalesValue) }}</span>
                    </div>
                    <div class="flex justify-between text-lg border-b py-2 text-rose-500">
                        <span>Total Harga Pokok (COGS)</span>
                        <span>- Rp {{ formatIDR(totalSalesValue - totalProfit) }}</span>
                    </div>
                    <div class="flex justify-between text-2xl font-black py-4 border-t-2 border-slate-900 mt-4">
                        <span>Laba Kotor</span>
                        <span class="text-emerald-600">Rp {{ formatIDR(totalProfit) }}</span>
                    </div>
                </div>
            </div>
        </div>

    </main>
</div>

<script>
    const { createApp } = Vue;

    createApp({
        data() {
            return {
                view: 'dashboard',
                lastUpdate: new Date().toLocaleTimeString(),
                products: [
                    { id: 1, name: 'MacBook Pro M3', category: 'Laptop', stock: 15, cost: 21000000, price: 25000000 },
                    { id: 2, name: 'iPhone 15 Pro', category: 'Mobile', stock: 5, cost: 15000000, price: 18500000 },
                    { id: 3, name: 'Logitech MX Master', category: 'Aksesoris', stock: 42, cost: 800000, price: 1500000 },
                    { id: 4, name: 'Monitor LG UltraWide', category: 'Display', stock: 8, cost: 4500000, price: 6200000 },
                ],
                salesHistory: [
                    { time: '09:12', productId: 3, qty: 2, total: 3000000, profit: 1400000 }
                ],
                customers: [
                    { name: 'Andi Pratama', email: 'andi@gmail.com' },
                    { name: 'Siti Rahma', email: 'siti@cloud.com' },
                    { name: 'Budi Santoso', email: 'budi@tech.id' }
                ],
                transaction: { productId: 1, qty: 1 }
            }
        },
        computed: {
            totalSalesValue() {
                return this.salesHistory.reduce((acc, s) => acc + s.total, 0);
            },
            totalProfit() {
                return this.salesHistory.reduce((acc, s) => acc + s.profit, 0);
            },
            lowStockCount() {
                return this.products.filter(p => p.stock < 10).length;
            }
        },
        methods: {
            navClass(active) {
                return `w-full text-left p-3.5 rounded-xl transition-all duration-200 flex items-center gap-2 ${active ? 'bg-blue-600 text-white shadow-lg shadow-blue-900/50' : 'text-slate-400 hover:bg-slate-800 hover:text-white'}`;
            },
            formatIDR(num) {
                return num.toLocaleString('id-ID');
            },
            getProductName(id) {
                return this.products.find(p => p.id === id)?.name || 'Produk';
            },
            processTransaction() {
                const prod = this.products.find(p => p.id === this.transaction.productId);
                if (prod && prod.stock >= this.transaction.qty) {
                    const total = prod.price * this.transaction.qty;
                    const profit = (prod.price - prod.cost) * this.transaction.qty;
                    
                    this.salesHistory.unshift({
                        time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                        productId: prod.id,
                        qty: this.transaction.qty,
                        total: total,
                        profit: profit
                    });

                    prod.stock -= this.transaction.qty;
                    this.lastUpdate = new Date().toLocaleTimeString();
                    this.updateChart(); // Refresh grafik
                } else {
                    alert("⚠️ Peringatan: Stok tidak mencukupi untuk transaksi ini!");
                }
            },
            initChart() {
                const ctx = document.getElementById('salesChart');
                if(!ctx) return;
                
                window.myChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['08:00', '10:00', '12:00', '14:00', '16:00', '18:00'],
                        datasets: [{
                            label: 'Pendapatan (Jutaan Rp)',
                            data: [5, 12, 8, 15, 25, this.totalSalesValue / 1000000],
                            borderColor: '#2563eb',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: { responsive: true, plugins: { legend: { display: false } } }
                });
            },
            updateChart() {
                if(window.myChart) {
                    window.myChart.data.datasets[0].data[5] = this.totalSalesValue / 1000000;
                    window.myChart.update();
                }
            }
        },
        mounted() {
            this.initChart();
        },
        watch: {
            view(newVal) {
                if(newVal === 'dashboard') {
                    setTimeout(() => this.initChart(), 100);
                }
            }
        }
    }).mount('#app')
</script>
</body>
</html>
